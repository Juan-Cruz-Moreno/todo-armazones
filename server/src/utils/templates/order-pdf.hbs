<html>
  <head>
    <meta charset="utf-8" />
    <title>Orden #{{orderNumber}}</title>
    <style>
      body {
        font-family: 'Segoe UI', Arial, sans-serif;
        background: #fff;
        color: #111;
        margin: 0;
        padding: 0;
        padding-bottom: 80px;
      }

      .header {
        background: #fff;
        border-bottom: 1px solid #e0e0e0;
        padding: 24px 24px 16px 24px;
        margin: 32px 40px 0 40px;
        text-align: center;
      }

      .logo {
        height: 100px;
        width: 120px;
        margin-left: 20px;
        background: none;
      }

      .sub-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 0;
        text-align: left;
      }

      .sub-header div {
        flex: 1;
      }

      .order-info {
        background: #fff;
        margin: 32px 40px 0 40px;
        padding: 24px 24px 16px 24px;
      }

      .order-label {
        font-size: 1rem;
        color: #222;
        font-weight: 500;
        letter-spacing: 1px;
      }

      .order-number {
        font-size: 2rem;
        font-weight: bold;
        color: #000;
        margin-bottom: 8px;
        letter-spacing: 1px;
      }

      .meta {
        margin-bottom: 8px;
        color: #222;
      }

      .section-title {
        font-size: 1rem;
        color: #111;
        margin-top: 24px;
        margin-bottom: 8px;
        font-weight: 600;
        letter-spacing: 0.5px;
      }

      /* === Nueva tabla más "user friendly" === */
      table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0 8px;
        margin-top: 16px;
        margin-bottom: 40px;
      }

      th {
        background: #9797aa;
        color: #fff;
        font-weight: 600;
        padding: 12px 10px;
        text-align: left;
      }

      th:nth-child(2),
      th:nth-child(3),
      th:nth-child(4) {
        text-align: center;
      }

      td {
        background: #fff;
        padding: 12px 10px;
        border: none;
        box-shadow: none;
      }

      tr td:first-child {
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
      }

      tr td:last-child {
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
      }

      td:nth-child(2),
      td:nth-child(3),
      td:nth-child(4) {
        text-align: center;
        font-variant-numeric: tabular-nums;
      }

      .total-row td {
        background: #f5f5f5;
        font-weight: bold;
        font-size: 1.05rem;
        color: #000;
        box-shadow: none;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1 style="margin: 0; font-size: 1.5rem;">FACTURA</h1>
      <div class="sub-header">
        <div style="text-align: left;">
          <strong>TODO ARMAZONES</strong><br />
          Buenos Aires, Argentina
        </div>
        <div style="text-align: right;">
          <img src="{{logoUrl}}" class="logo" alt="Logo TODO ARMAZONES" />
        </div>
      </div>
    </div>

    <div class="order-info">
      <div class="order-label">Orden</div>
      <div class="order-number">#{{orderNumber}}</div>
      <div class="meta"><strong>Fecha:</strong> {{createdAt}}</div>

      <div class="section-title">Información del Cliente:</div>
      <div class="meta"><strong>Nombre:</strong> {{user.firstName}} {{user.lastName}}</div>
      <div class="meta"><strong>Email:</strong> {{user.email}}</div>
      <div class="meta"><strong>Teléfono:</strong> {{user.phone}}</div>
      <div class="meta"><strong>DNI:</strong> {{user.dni}}</div>

      <div class="section-title">Dirección de Envío</div>
      <div class="meta">
        {{shippingAddress.streetAddress}}, {{shippingAddress.city}},
        {{shippingAddress.state}}, {{shippingAddress.postalCode}}
      </div>
      <div class="meta"><strong>Tel:</strong> {{shippingAddress.phoneNumber}} |
        <strong>DNI:</strong> {{shippingAddress.dni}}
      </div>
      <div class="meta"><strong>Método de envío:</strong> {{shippingMethodLabel}}</div>

      {{#if isParcelCompany}}
        {{#if shippingAddress.shippingCompany}}
          <div class="meta"><strong>Empresa de paquetería:</strong> {{shippingAddress.shippingCompany}}</div>
        {{/if}}
        {{#if shippingAddress.declaredShippingAmount}}
          <div class="meta"><strong>Monto declarado envío:</strong> {{shippingAddress.declaredShippingAmount}}</div>
        {{/if}}
      {{/if}}

      {{#if isMotorcycle}}
        {{#if shippingAddress.deliveryWindow}}
          <div class="meta"><strong>Franja horaria de entrega:</strong> {{shippingAddress.deliveryWindow}}</div>
        {{/if}}
      {{/if}}

      <div class="meta"><strong>Método de pago:</strong> {{paymentMethodLabel}}</div>

      <table>
        <thead>
          <tr>
            <th>Producto</th>
            <th>Cantidad</th>
            <th>Precio USD</th>
            <th>Subtotal USD</th>
          </tr>
        </thead>
        <tbody>
          {{#each items}}
            <tr>
              <td>
                <div>
                  <span>{{productVariant.product.productModel}}</span>
                </div>
                <div style="display: flex; align-items: center; margin-top: 4px;">
                  <span>{{productVariant.colorName}}</span>
                  <span style="display: inline-block; width: 12px; height: 12px; border-radius: 50%; background-color: {{productVariant.colorHex}}; margin-left: 8px;"></span>
                </div>
              </td>
              <td>{{quantity}}</td>
              <td>{{priceUSDAtPurchase}}</td>
              <td>{{subTotal}}</td>
            </tr>
          {{/each}}

          <!-- Subtotal general -->
          <tr class="total-row">
            <td colspan="3" style="text-align:right;">Subtotal USD:</td>
            <td>{{subTotal}}</td>
          </tr>

          {{#if showBankTransferExpense}}
            <tr class="total-row">
              <td colspan="3" style="text-align:right;">Gasto por transferencia bancaria USD:</td>
              <td>{{bankTransferExpense}}</td>
            </tr>
          {{/if}}

          <tr class="total-row">
            <td colspan="3" style="text-align:right;">Total USD:</td>
            <td>{{totalAmount}}</td>
          </tr>

          <tr class="total-row">
            <td colspan="3" style="text-align:right;">Total ARS:</td>
            <td>{{totalAmountARS}}</td>
          </tr>

        </tbody>
      </table>
    </div>
  </body>
</html>
